<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <div class="container">
    <h2>Admin Panel</h2>
    <a href="/logout">Logout</a>

    <h3>Tokens</h3>
    <form method="post">
      <input type="text" name="token" placeholder="Token" required>
      <input type="number" name="days" value="30" min="1">
      <button name="add_token">Add Token</button>
    </form>
    <table>
      <tr><th>Token</th><th>Expiry</th><th>IPs</th><th>Banned</th><th>Actions</th></tr>
      {% for t in tokens %}
      <tr>
        <td>{{ t[0] }}</td>
        <td>{{ t[1][:19].replace('T', ' ') }}</td>
        <td>{{ t[2] }}</td>
        <td>{{ 'Yes' if t[3] else 'No' }}</td>
        <td>
          <a href="/admin/action/{{t[0]}}/delete">Delete</a> |
          <a href="/admin/action/{{t[0]}}/reset">Reset IPs</a> |
          <a href="/admin/action/{{t[0]}}/renew">Renew</a> |
          <a href="/admin/action/{{t[0]}}/ban">Ban</a>
        </td>
      </tr>
      {% endfor %}
    </table>

    <h3>Add Channel</h3>
    <form method="post">
      <input type="text" name="name" placeholder="Channel Name" required>
      <input type="text" name="stream" placeholder="Stream URL" required>
      <input type="text" name="logo" placeholder="Logo URL">
      <button name="add_channel">Add</button>
    </form>

    <h3>Channels</h3>
    <table>
      <tr><th>Name</th><th>Stream URL</th><th>Logo</th><th>Actions</th></tr>
      {% for c in channels %}
      <tr>
        <td>{{ c[1] }}</td>
        <td>{{ c[2] }}</td>
        <td><img src="{{ c[3] }}" height="24"></td>
        <td><a href="/admin/delete_channel/{{c[0]}}">Delete</a></td>
      </tr>
      {% endfor %}
    </table>

    <h3>Logs</h3>
    <table>
      <tr><th>Time</th><th>IP</th><th>Token</th><th>UA</th><th>Referrer</th></tr>
      {% for log in logs %}
      <tr>
        <td>{{ log[0][:19].replace('T', ' ') }}</td>
        <td>{{ log[1] }}</td>
        <td>{{ log[2] }}</td>
        <td>{{ log[3][:30] }}...</td>
        <td>{{ log[4] }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>
</body>
</html>
